$nz-form-field-anim-duration ?= 200ms cubic-bezier(0.215, 0.61, 0.355, 1)
// $nz-form-field-input-padding ?= 4px
// $nz-form-field-top-caption-height ?= 16px
// $nz-form-field-bottom-caption-height ?= 20px
// $nz-form-field-outline-radius ?= 5px

// variant=underlined
// variant=filled
// variant=stroked

// .nz-form-field
//   position: relative
//   display: inline-block
//   width: auto
//   padding-top: $nz-form-field-top-caption-height
//   overflow: hidden

//   .underline
//     height: 1px
//     background: $theme.base.on.normal
//     position: relative

//   .nz-form-field-ripple
//     height: 2px
//     position: absolute
//     top: 0px
//     opacity: 0
//     background: $theme.accent.normal
//     width: 100%

//     transform-origin: 50%
//     transform: scaleX(.5)

//     transition: transform $nz-form-field-anim-duration, opacity $nz-form-field-anim-duration

//   &.ng-invalid
//     .nz-form-field-ripple
//       background: $theme.critical.normal !important
//       opacity: 1
//       transform: scaleX(1)

//   &.nz-focused
//     .nz-form-field-ripple
//       opacity: 1
//       transform: scaleX(1)

//   &[disabled]
//     cursor: default !important
//     opacity: 0.3 !important
//     pointer-events: none

//   caption
//     height: $nz-form-field-bottom-caption-height
//     line-height: $nz-form-field-bottom-caption-height

//     white-space: nowrap
//     text-overflow: ellipsis
//     overflow: hidden

//     color: $theme.base.on.light

//   .nz-button[variant~="icon"][variant~="tiny"][nzslot]
//     margin: -4px 4px -20px 4px

// .nz-form-field-outline
//   display: flex
//   flex-direction: row
//   flex-wrap: nowrap
//   justify-content: flex-start
//   align-items: stretch
//   align-content: stretch
//   user-select: none
//   pointer-events: none


$nz-ff-anim-duration ?= 150ms cubic-bezier(0.215, 0.61, 0.355, 1)
// $nz-ff-normal-height ?= nz-local-grid-size(9)
$nz-ff-normal-height ?= nz-local-grid-size(11)
$nz-ff-top-caption-height ?= 16px
$nz-ff-bottom-caption-height ?= 20px
$nz-ff-outline-radius ?= 4px
$nz-ff-outline-inset ?= 8px


.nz-form-field
  position: relative

  .content
    position: relative
    z-idnex: 5

    display: flex
    flex-direction: row
    flex-wrap: nowrap
    justify-content: flex-start
    align-items: center
    align-content: center

  .input
    flex: 1 1 1%
    max-width: 100%

  .decor
    position: absolute
    z-index: 1
    top: 0
    left: 0
    right: 0
    bottom: 0

    user-select: none
    pointer-events: none

    .nz-form-field-ripple
      position: absolute
      left: 0
      right: 0
      bottom: -1px
      height: 2px
      opacity: 0

      transform-origin: 50%
      transform: scaleX(.5)
      transition: transform $nz-ff-anim-duration, opacity $nz-ff-anim-duration

    .nz-form-field-outline
      position: absolute
      top: 0
      left: 0
      right: 0
      bottom: 0

  .before-input, .after-input
    flex: none
    white-space: nowrap
    cursor: default

    align-self: stretch
    display: flex
    flex-direction: row
    flex-wrap: nowrap
    justify-content: flex-start
    align-items: center
    align-content: center


  /*
  .placeholder
    flex: 1 1
    position: absolute
    top: 10px
    left: 10px
  */

  .nz-placeholder
    position: absolute
    top: $nz-ff-top-caption-height - 2px
    left: $nz-ff-outline-inset
    right: $nz-ff-outline-inset
    max-width: 100%

  .caption
    nz-typo: $typo.caption
    display: flex
    flex-direction: row
    flex-wrap: nowrap
    justify-content: flex-start
    align-items: center
    align-content: center
    white-space: nowrap
    text-overflow: ellipsis
    overflow: hidden


  &, &[variant~="normal"]
    .input
      nz-typo: $typo.body2
      min-height: $nz-ff-normal-height

    .nz-placeholder
      nz-typo: $typo.body2

    // &:not([variant~="slim"])

    //   min-height: $nz-ff-normal-height + $nz-ff-bottom-caption-height

  &:not([variant~="slim"])
    .caption
      height: $nz-ff-bottom-caption-height
      color: $theme.common.normal

  &[variant~="underline"]
    .input
      padding-top: $nz-ff-top-caption-height
      padding-bottom: 4px

    .decor
      border-bottom: 1px solid $theme.common.dark

    .nz-placeholder
      left: 0px
      right: 0px

      &[isHidden]
        margin-top: 4px

    &:not([variant~="transparent"])
      .content
        padding-left: $nz-ff-outline-inset
        padding-right: $nz-ff-outline-inset

      .decor
        background: alpha($theme.base.on.normal, 0.05)
        border-top-left-radius: $nz-ff-outline-radius
        border-top-right-radius: $nz-ff-outline-radius

      .caption
        padding: 0 $nz-ff-outline-inset

      .nz-placeholder
        left: $nz-ff-outline-inset
        right: $nz-ff-outline-inset


  &[variant~="outline"]
    .input
      padding-top: $nz-ff-outline-inset + 4px
      padding-bottom: $nz-ff-outline-inset + 4px

    .content
      padding-left: $nz-ff-outline-inset
      padding-right: $nz-ff-outline-inset

    .caption
      padding: 0 $nz-ff-outline-inset

    .nz-placeholder
      left: $nz-ff-outline-inset
      right: $nz-ff-outline-inset

      &[isHidden]
        margin-top: -4px


  &.ng-invalid
    .nz-form-field-outline
      & > *
        border-color: $theme.critical.normal
        border-width: 2px

    .nz-placeholder
      > label
        color: $theme.critical.normal !important

    .nz-form-field-ripple
      background: $theme.critical.normal !important
      opacity: 1
      transform: scaleX(1)

    &[variant~="underline"]:not([variant~="transparent"])
      .decor
        background: alpha($theme.critical.normal, 0.05)

      // &.nz-focused
      //   .decor
      //     background: alpha($theme.critical.normal, 0.1)

  &.nz-focused
    .nz-form-field-outline
      & > *
        border-color: $theme.accent.normal
        border-width: 2px

    .nz-placeholder
      > label
        color: $theme.accent.normal !important

    .nz-form-field-ripple
      background: $theme.accent.normal !important
      opacity: 1
      transform: scaleX(1)

    &[variant~="underline"]
      &:not([variant~="transparent"])
        .decor
          background: alpha($theme.base.on.normal, 0.1)

  &[disabled]
    cursor: default !important
    opacity: 0.3 !important
    pointer-events: none


.nz-form-field-outline
  display: flex
  flex-direction: row
  flex-wrap: nowrap
  justify-content: flex-start
  align-items: stretch
  align-content: stretch

  & > *
    border-color: $theme.common.dark
    border-width: 1px
    transition: border-color $nz-ff-anim-duration
